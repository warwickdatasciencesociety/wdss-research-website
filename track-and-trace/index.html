<!DOCTYPE html><html lang="en" data-theme="light"><head><script type="text/javascript" src="//downloads.mailchimp.com/js/signup-forms/popup/unique-methods/embed.js" data-dojo-config="usePlainJson: true, isDebug: false"></script><script type="text/javascript">window.dojoRequire(["mojo/signup-forms/Loader"],function(o){o.start({baseUrl:"mc.us4.list-manage.com",uuid:"1fd8b3cd2ba70f51528f758b7",lid:"0a5bf38afd",uniqueMethods:!0})})</script><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Reinventing Test and Trace: A Bayesian Approach For Modelling SARS-CoV-2 Setting-Specific Transmission | Research @ WDSS</title><meta name="description" content="One of the key failures many countries had in dealing with the COVID-19 pandemic was a lack of coherent, data-driven analysis on setting-specific transmission risk. In this article, we outline a novel first-principles hierarchical Bayesian model for setting-specific transmission that, alongside the corresponding data collection methodology, could help governments in determining pandemic control policy"><meta name="keywords" content="covid19,bayesian-modelling,track-and-trace"><meta name="author" content="Warwick Data Science"><meta name="copyright" content="Warwick Data Science"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Reinventing Test and Trace: A Bayesian Approach For Modelling SARS-CoV-2 Setting-Specific Transmission"><meta name="twitter:description" content="One of the key failures many countries had in dealing with the COVID-19 pandemic was a lack of coherent, data-driven analysis on setting-specific transmission risk. In this article, we outline a novel first-principles hierarchical Bayesian model for setting-specific transmission that, alongside the corresponding data collection methodology, could help governments in determining pandemic control policy"><meta name="twitter:image" content="https://research.wdss.io/banners/covid.jpg"><meta property="og:type" content="article"><meta property="og:title" content="Reinventing Test and Trace: A Bayesian Approach For Modelling SARS-CoV-2 Setting-Specific Transmission"><meta property="og:url" content="https://research.wdss.io/track-and-trace/"><meta property="og:site_name" content="Research @ WDSS"><meta property="og:description" content="One of the key failures many countries had in dealing with the COVID-19 pandemic was a lack of coherent, data-driven analysis on setting-specific transmission risk. In this article, we outline a novel first-principles hierarchical Bayesian model for setting-specific transmission that, alongside the corresponding data collection methodology, could help governments in determining pandemic control policy"><meta property="og:image" content="https://research.wdss.io/banners/covid.jpg"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode="1",t=Cookies.get("theme");if("1"==autoChangeMode){var isDarkMode=window.matchMedia("(prefers-color-scheme: dark)").matches,isLightMode=window.matchMedia("(prefers-color-scheme: light)").matches,isNotSpecified=window.matchMedia("(prefers-color-scheme: no-preference)").matches,hasNoSupport=!isDarkMode&&!isLightMode&&!isNotSpecified;if(void 0===t){if(isLightMode)activateLightMode();else if(isDarkMode)activateDarkMode();else if(isNotSpecified||hasNoSupport){console.log("You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.");var now=new Date,hour=now.getHours(),isNight=hour<6||18<=hour;isNight?activateDarkMode():activateLightMode()}}else"light"==t?activateLightMode():activateDarkMode()}else"2"==autoChangeMode?(isNight=(hour=(now=new Date).getHours())<6||18<=hour,void 0===t?isNight?activateDarkMode():activateLightMode():"light"===t?activateLightMode():activateDarkMode()):"dark"==t?activateDarkMode():"light"==t&&activateLightMode();function activateDarkMode(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#000")}function activateLightMode(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#fff")}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><link rel="canonical" href="https://research.wdss.io/track-and-trace/"><link rel="prev" title="Oh Hell! - Reinforcement Learning for solving card games" href="https://research.wdss.io/oh-hell/"><link rel="next" title="Predicting aqueous solubility with neural networks" href="https://research.wdss.io/chemical-properties/"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"4718922828481704",enable_page_level_ads:"true"})</script><script data-ad-client="ca-pub-4718922828481704" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"search.xml",languages:{hits_empty:"We didn't find any results for: ${query}"}},translate:void 0,copy:{success:"Copied successfully",error:"Copy failed",noSupport:"Not supported by browser"},bookmark:{message_prev:"Press",message_next:"to bookmark this page"},runtime_unit:"days",runtime:!0,copyright:void 0,ClickShowText:void 0,medium_zoom:!1,fancybox:!0,Snackbar:{bookmark:{message_prev:"Press",message_next:"to bookmark this page"},chs_to_cht:"Traditional Chinese Activated Manually",cht_to_chs:"Simplified Chinese Activated Manually",day_to_night:"Dark Mode Activated Manually",night_to_day:"Light Mode Activated Manually",bgLight:"#49b1f5",bgDark:"#2d3035",position:"bottom-left"},baiduPush:!1,highlightCopy:!0,highlightLang:!0,highlightShrink:"false",isFontAwesomeV5:!1,isPhotoFigcaption:!1}</script><script>var GLOBAL_CONFIG_SITE={isPost:!0,isHome:!1,isSidebar:!0}</script><noscript><style>#page-header{opacity:1}.justified-gallery img{opacity:1}</style></noscript><meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="Research @ WDSS" type="application/atom+xml">
</head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">Articles</div><div class="length_num">23</div></a></div></div><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/tags/"><div class="headline">Tags</div><div class="length_num">37</div></a></div></div><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/categories/"><div class="headline">Categories</div><div class="length_num">23</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">Contents</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduction"><span class="toc-number">1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Our-approach-and-assumptions"><span class="toc-number">2.</span> <span class="toc-text">Our approach and assumptions</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Data-collection-methodology"><span class="toc-number">2.1.</span> <span class="toc-text">Data collection methodology</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Model-assumptions"><span class="toc-number">2.2.</span> <span class="toc-text">Model assumptions</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Building-a-first-principles-model"><span class="toc-number">3.</span> <span class="toc-text">Building a first-principles model</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#The-base-model"><span class="toc-number">3.1.</span> <span class="toc-text">The base model</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Curbing-selection-bias"><span class="toc-number">3.2.</span> <span class="toc-text">Curbing selection bias</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Addressing-inaccurate-tests"><span class="toc-number">3.3.</span> <span class="toc-text">Addressing inaccurate tests</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hierarchical-extension"><span class="toc-number">3.4.</span> <span class="toc-text">Hierarchical extension</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Modelling-policy-interventions"><span class="toc-number">3.5.</span> <span class="toc-text">Modelling policy interventions</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Simulating-our-data"><span class="toc-number">4.</span> <span class="toc-text">Simulating our data</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Metadata"><span class="toc-number">4.1.</span> <span class="toc-text">Metadata</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Population-ground-truth"><span class="toc-number">4.2.</span> <span class="toc-text">Population ground truth</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Fitting-our-Model"><span class="toc-number">5.</span> <span class="toc-text">Fitting our Model</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Our-model-in-Stan"><span class="toc-number">5.1.</span> <span class="toc-text">Our model in Stan</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Markov-Chain-Monte-Carlo-Posterior-Sampling"><span class="toc-number">5.2.</span> <span class="toc-text">Markov Chain Monte Carlo Posterior Sampling</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Results-and-conclusion"><span class="toc-number">6.</span> <span class="toc-text">Results and conclusion</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Visualizing-posterior-samples"><span class="toc-number">6.1.</span> <span class="toc-text">Visualizing posterior samples</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Comparison-with-ground-truth"><span class="toc-number">6.2.</span> <span class="toc-text">Comparison with ground truth</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Conclusion-and-future-work"><span class="toc-number">6.3.</span> <span class="toc-text">Conclusion and future work</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image:url(/banners/covid.jpg)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">Research @ WDSS</a></span><span class="pull_right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">Reinventing Test and Trace: A Bayesian Approach For Modelling SARS-CoV-2 Setting-Specific Transmission</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="Created 2021-11-14 00:00:00"><i class="fa fa-calendar" aria-hidden="true"></i> Created 2021-11-14</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="Updated 2021-11-14 00:00:00"><i class="fa fa-history" aria-hidden="true"></i> Updated 2021-11-14</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><a class="post-meta__categories" href="https://www.linkedin.com/in/tim-hargreaves/" target="_blank" rel="noopener">Tim Hargreaves</a><span>, </span><a class="post-meta__categories" href="https://www.linkedin.com/in/patriciohdzs/" target="_blank" rel="noopener">Patricio Hernandez</a></span></div><div class="meta-secondline"><span class="post-meta-wordcount"><i class="post-meta__icon fa fa-file-word-o" aria-hidden="true"></i><span>Word count:</span><span class="word-count">4.6k</span><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-clock-o" aria-hidden="true"></i><span>Reading time: 28 min</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"><span class="post-meta__separator">|</span></span><span class="post-meta-commentcount"><i class="post-meta__icon fa fa-comment-o" aria-hidden="true"></i><span>Comments:</span><span class="disqus-comment-count comment-count"><a href="https://research.wdss.io/track-and-trace/#disqus_thread"></a></span></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div id="article-container"><h2 id="Introduction">Introduction</h2><p>It is no secret that the response of multiple countries following the outbreak of the COVID-19 pandemic has been abismal - and the UK is no exception. With £355 billion amounting in economic losses (OBR, 2021), a 4.8% rate of unemployment (ONS, 2021) and, perhaps most shockingly, over 128,000 deaths to this date (<a href="http://Gov.uk" target="_blank" rel="noopener">Gov.uk</a>, 2021), the UK government has undoubtedly handled this crisis poorly, with two key government-led programmes standing out amongst the list of policy failures.</p><p>The Test and Trace programme, established to curb Coronavirus reproduction, aims to provide accessible testing as well as contact tracing to notify exposed individuals and instruct them to self-isolate. One major failure of the T&amp;T programme has been the lack of a coherent data collection strategy for analysing setting-specific transmission; that is, the relative likelihood of contracting COVID in different locations, such as a hair dresser, a restaurant, etc. Given the dependence of the UK Tier System on our understanding of setting-specific transmission, this alone serves as an explanation of the latter’s failure, as settings grouped together often bear no resemblance in terms of their underlying transmission rates, resulting in unnecessary business closures and contributing to the economic hemorrhage.</p><p>Thus, we set out to formulate a data collection and analysis methodology that is both compatible with the current T&amp;T programme and enables us to model and estimate setting-specific COVID-19 transmission rates, in the hope of guiding lockdown policies using a reliable, data-driven approach.</p><h2 id="Our-approach-and-assumptions">Our approach and assumptions</h2><h3 id="Data-collection-methodology">Data collection methodology</h3><p>Starting out, our goal was to model a random vector <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">θ</mi><mo>∈</mo><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><msup><mo stretchy="false">]</mo><mi>P</mi></msup></mrow><annotation encoding="application/x-tex">\boldsymbol{\theta} \in [0,1]^P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.73354em;vertical-align:-.0391em"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:.03194em">θ</span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.0913309999999998em;vertical-align:-.25em"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">1</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8413309999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">P</span></span></span></span></span></span></span></span></span></span></span> of transmission rates for <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.13889em">P</span></span></span></span> different settings. To estimate this model, we would require data that could be feasibly collected through the T&amp;T programme. Therefore, we devised the following data collection strategy to accompany the probabilistic model developed below, making sure to prioritize its feasibility and scalability:</p><ol><li><p>Data is to be collected from individuals in the T&amp;T programme through a short survey of binary responses on whether or not they visited each one of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.13889em">P</span></span></span></span> locations in the last few days.</p></li><li><p>For each individual surveyed through T&amp;T, the result of their COVID-19 antigen test is also observed.</p></li><li><p>Finally, a random survey is also sent out. This survey is identical to the one in (1.) but, since it is not distributed by T&amp;T, no antigen test is taken and therefore no outcome is observed.</p></li></ol><h3 id="Model-assumptions">Model assumptions</h3><p>In order for us to combine this data collection methodology with a statistical model that allows for inference on the estimated setting-specific transmission rates, we had to lay down the following assumptions:</p><ul><li>Multiple visits to a location in one week are rare enough to be ignored or in cases (such as supermarkets) where multiple visits are expected, the distribution of number of visits is tight.</li></ul><h2 id="Building-a-first-principles-model">Building a first-principles model</h2><p>Given the data collection strategy detailed above, for each individual, we observe a binary vector <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold-italic">x</mi><mi>i</mi></msub><mo>∈</mo><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><msup><mo stretchy="false">}</mo><mi>P</mi></msup></mrow><annotation encoding="application/x-tex">\boldsymbol{x}_i \in \{0,1\}^{P}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6891em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.0913309999999998em;vertical-align:-.25em"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8413309999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">P</span></span></span></span></span></span></span></span></span></span></span></span>, which indicates their responses on the location visits survey, and random variable <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>∈</mo><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">y_i \in \{0,1\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7335400000000001em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">1</span><span class="mclose">}</span></span></span></span> which indicates if they tested positive for COVID-19.</p><h3 id="The-base-model">The base model</h3><p>We formulate our model generatively through the latent transmission vector <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold-italic">t</mi><mi>i</mi></msub><mo>∈</mo><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><msup><mo stretchy="false">}</mo><mi>P</mi></msup></mrow><annotation encoding="application/x-tex">\boldsymbol{t}_i \in \{0,1\}^{P}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7849200000000001em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">t</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.0913309999999998em;vertical-align:-.25em"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8413309999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">P</span></span></span></span></span></span></span></span></span></span></span></span>, which follows a multivariate Bernoulli distribution with transmission probabilities dependent on the individual’s attendance to each setting and the respective setting-specific transmission rates. Furthermore, we capture the case of COVID transmission in a location not specified by the survey through the latent variable <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub><mo>∈</mo><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><msup><mo stretchy="false">}</mo><mi>P</mi></msup></mrow><annotation encoding="application/x-tex">b_i \in \{0,1\}^{P}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.0913309999999998em;vertical-align:-.25em"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8413309999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">P</span></span></span></span></span></span></span></span></span></span></span></span>, which is analogous to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold-italic">t</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\boldsymbol{t}_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7849200000000001em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">t</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>, but parameterized by the underlying base transmission risk:</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="bold-italic">t</mi><mi>i</mi></msub><mo>∼</mo><mtext>Ber</mtext><mo stretchy="false">(</mo><msub><mi mathvariant="bold-italic">x</mi><mi>i</mi></msub><mo>∘</mo><mi mathvariant="bold-italic">θ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\boldsymbol{t}_i \sim \text{Ber}(\boldsymbol{x}_i \circ \boldsymbol{\theta})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7849200000000001em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">t</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord text"><span class="mord">Ber</span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∘</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:.03194em">θ</span></span></span><span class="mclose">)</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub><mo>∼</mo><mtext>Ber</mtext><mo stretchy="false">(</mo><mi>ρ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">b_i \sim \text{Ber}(\rho)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord text"><span class="mord">Ber</span></span><span class="mopen">(</span><span class="mord mathnormal">ρ</span><span class="mclose">)</span></span></span></span></span></p><p>We denote whether or not the individual contracted COVID-19 with the binary variable <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">w_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.02691em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> and define it using the natural relationship with the aforementioned latent variables. Since transmission in any of the settings surveyed or in some other unaccounted location results in contraction, we define <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">w_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.02691em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> as the indicator of this scenario:</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub><mo>=</mo><mn mathvariant="double-struck">1</mn><mo stretchy="false">{</mo><msup><mtext mathvariant="bold">1</mtext><mtext>T</mtext></msup><msub><mi mathvariant="bold-italic">t</mi><mi>i</mi></msub><mo>+</mo><msub><mi>b</mi><mi>i</mi></msub><mo>&gt;</mo><mn>0</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">w_i=\mathbb{1}\{\textbf{1}^\text{T}\boldsymbol{t}_i + b_i&gt;0\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.02691em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.1413309999999999em;vertical-align:-.25em"></span><span class="mord"><span class="mord">1</span></span><span class="mopen">{</span><span class="mord"><span class="mord text"><span class="mord textbf">1</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8913309999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">T</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">t</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">0</span><span class="mclose">}</span></span></span></span></span></p><h3 id="Curbing-selection-bias">Curbing selection bias</h3><p>The next challenge for our model was to account for selection bias in T&amp;T survey observations. More specifically, infected individuals (who feel unwell and present symptoms) are more likely to get in contact with T&amp;T and hence select into the survey, thus introducing bias into any transmission rate estimates. To mitigate this, we collect observations of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold-italic">x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\boldsymbol{x}_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.59444em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> from a random survey and define <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">s_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> to indicate whether or not the observation came from T&amp;T:</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>s</mi><mi>i</mi></msub><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>1</mn><mo separator="true">,</mo><mtext>  </mtext><mtext>T&amp;T sample</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>0</mn><mo separator="true">,</mo><mtext>  </mtext><mtext>otherwise</mtext></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">s_i=\begin{cases} 1,\; \text{T\&amp;T sample} \\ 0,\; \text{otherwise} \end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:3.0000299999999998em;vertical-align:-1.25003em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em"><span style="top:-3.69em"><span class="pstrut" style="height:3.008em"></span><span class="mord"><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord text"><span class="mord">T&amp;T sample</span></span></span></span><span style="top:-2.25em"><span class="pstrut" style="height:3.008em"></span><span class="mord"><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord text"><span class="mord">otherwise</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>From there, we utilize <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">s_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> to define the testing rates as the probability of getting tested conditional on being COVID-19 infected, and use these to weight down the transmission likelihood for our observations.</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="double-struck">P</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mi mathvariant="normal">∣</mi><msub><mi>w</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><msub><mi>γ</mi><mo>+</mo></msub></mrow><annotation encoding="application/x-tex">\mathbb{P}(s_i=1|w_i=1) = \gamma_+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathbb">P</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.02691em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.638891em;vertical-align:-.208331em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05556em">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.25833100000000003em"><span style="top:-2.5500000000000003em;margin-left:-.05556em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="double-struck">P</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mi mathvariant="normal">∣</mi><msub><mi>w</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn><mo stretchy="false">)</mo><mo>=</mo><msub><mi>γ</mi><mo>−</mo></msub></mrow><annotation encoding="application/x-tex">\mathbb{P}(s_i=1|w_i=0) = \gamma_-</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathbb">P</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.02691em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.638891em;vertical-align:-.208331em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05556em">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.25833100000000003em"><span style="top:-2.5500000000000003em;margin-left:-.05556em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span></span></span></span></span></p><h3 id="Addressing-inaccurate-tests">Addressing inaccurate tests</h3><p>Similarly, we also account for false positive and negative antigen test results by defining the test sensitivity and specificity parameters through the conditional probability of testing positive given infected and testing negative given non-infected, respectively:</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="double-struck">P</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mi mathvariant="normal">∣</mi><msub><mi>w</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><msub><mi>λ</mi><mo>+</mo></msub></mrow><annotation encoding="application/x-tex">\mathbb{P}(y_i=1|w_i=1) = \lambda_+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathbb">P</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.02691em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.902771em;vertical-align:-.208331em"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.25833100000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="double-struck">P</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn><mi mathvariant="normal">∣</mi><msub><mi>w</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn><mo stretchy="false">)</mo><mo>=</mo><msub><mi>λ</mi><mo>−</mo></msub></mrow><annotation encoding="application/x-tex">\mathbb{P}(y_i=0|w_i=0) = \lambda_-</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathbb">P</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">0</span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.02691em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.902771em;vertical-align:-.208331em"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.25833100000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span></span></span></span></span></p><h3 id="Hierarchical-extension">Hierarchical extension</h3><p>We modeled the hierarchical nature of setting-specific transmission by grouping each setting into one of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span></span> encompassing classes of similar settings: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo><mo>:</mo><mo stretchy="false">[</mo><mi>P</mi><mo stretchy="false">]</mo><mo>→</mo><mo stretchy="false">[</mo><mi>K</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">c[p]:[P] \to [K]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">c</span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mclose">]</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:.13889em">P</span><span class="mclose">]</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:.07153em">K</span><span class="mclose">]</span></span></span></span>. For each class, we model transmission rates of member settings as draws from a <a href="https://en.wikipedia.org/wiki/Logit-normal_distribution" target="_blank" rel="noopener">logit-normal</a> distribution, parameterized by the mean class transmission rate <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">μ</mi><mo>∈</mo><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><msup><mo stretchy="false">]</mo><mi>K</mi></msup><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\boldsymbol{\mu} \in [0,1]^K,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7335400000000001em;vertical-align:-.19444em"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">μ</span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.0913309999999998em;vertical-align:-.25em"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">1</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8413309999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.07153em">K</span></span></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span> and the class transmission rate variance <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext> </mtext><msup><mi mathvariant="bold-italic">σ</mi><mn>2</mn></msup><mo>∈</mo><msubsup><mi mathvariant="double-struck">R</mi><mrow><mo>&gt;</mo><mn>0</mn></mrow><mi>K</mi></msubsup></mrow><annotation encoding="application/x-tex">\, \boldsymbol{\sigma}^2 \in \mathbb{R}_{&gt;0}^K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.853208em;vertical-align:-.0391em"></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:.03704em">σ</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.1168089999999997em;vertical-align:-.27547799999999995em"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8413309999999998em"><span style="top:-2.451892em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mrel mtight">&gt;</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.07153em">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.27547799999999995em"><span></span></span></span></span></span></span></span></span></span>. It should be noted that :</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>θ</mi><mi>p</mi></msub><mo>∼</mo><mtext>Logitnormal</mtext><mrow><mo fence="true">(</mo><mtext>logit</mtext><mrow><mo fence="true">(</mo><msub><mi>μ</mi><mrow><mi>c</mi><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo></mrow></msub><mo fence="true">)</mo></mrow><mtext>  </mtext><mo separator="true">,</mo><mtext>  </mtext><msubsup><mi>σ</mi><mrow><mi>c</mi><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo></mrow><mn>2</mn></msubsup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\theta_p \sim \text{Logitnormal}\left(\text{logit}\left(\mu_{c[p]}\right) \;,\; \sigma_{c[p]}^{2} \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.980548em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.80002em;vertical-align:-.65002em"></span><span class="mord text"><span class="mord">Logitnormal</span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size2">(</span></span><span class="mord text"><span class="mord">logit</span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.34480000000000005em"><span style="top:-2.5198em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mopen mtight">[</span><span class="mord mathnormal mtight">p</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.3551999999999999em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-2.428em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mopen mtight">[</span><span class="mord mathnormal mtight">p</span><span class="mclose mtight">]</span></span></span></span><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4469999999999999em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size2">)</span></span></span></span></span></span></span></p><h3 id="Modelling-policy-interventions">Modelling policy interventions</h3><p>Finally, we also wanted to model the effect of policy interventions on different setting classes to answer questions such as: <em>“Does social distancing have different effects in cinemas than in restaurants?”</em> To do this, we can introduce policy intervention parameters and model out their interactions with different setting transmission rates, provided our data collection methodology can be feasibly extended to collect the data necessary to pin down these additional parameters.</p><p>We exemplify this with the mask-wearing intervention, with the objective of estimating the different effects mask-wearing can have in different settings. To do this, we could extend our data collection survey to ask individuals about their mask-wearing habits, allowing us to define <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">m_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> as an indicator for habitual mask-wearers:</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>m</mi><mi>i</mi></msub><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>1</mn><mo separator="true">,</mo><mtext>  </mtext><mtext>habitual mask-wearing</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>0</mn><mo separator="true">,</mo><mtext>  </mtext><mtext>otherwise</mtext></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">m_i=\begin{cases} 1,\; \text{habitual mask-wearing} \\ 0,\; \text{otherwise} \end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:3.0000299999999998em;vertical-align:-1.25003em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em"><span style="top:-3.69em"><span class="pstrut" style="height:3.008em"></span><span class="mord"><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord text"><span class="mord">habitual mask-wearing</span></span></span></span><span style="top:-2.25em"><span class="pstrut" style="height:3.008em"></span><span class="mord"><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord text"><span class="mord">otherwise</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>This additional data then allows us to incorporate and estimate <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ι</mi><mrow><mi>c</mi><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo></mrow></msub></mrow><annotation encoding="application/x-tex">\iota_{c[p]}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7857599999999999em;vertical-align:-.3551999999999999em"></span><span class="mord"><span class="mord mathnormal">ι</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.34480000000000005em"><span style="top:-2.5198em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mopen mtight">[</span><span class="mord mathnormal mtight">p</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.3551999999999999em"><span></span></span></span></span></span></span></span></span></span> as the class-specific mas wearing impact on transmission rates:</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>θ</mi><mrow><mi>i</mi><mi>p</mi></mrow></msub><mo>∼</mo><mtext>Logitnormal</mtext><mrow><mo fence="true">(</mo><mtext> </mtext><mtext>logit</mtext><mrow><mo fence="true">(</mo><msub><mi>μ</mi><mrow><mi>c</mi><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo></mrow></msub><mo fence="true">)</mo></mrow><mo>+</mo><msub><mi>m</mi><mi>i</mi></msub><mi>log</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><msub><mi>ι</mi><mrow><mi>c</mi><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo></mrow></msub><mo fence="true">)</mo></mrow><mtext>  </mtext><mo separator="true">,</mo><mtext>  </mtext><msubsup><mi>σ</mi><mrow><mi>c</mi><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo></mrow><mn>2</mn></msubsup><mtext> </mtext><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\theta_{ip} \sim \text{Logitnormal}\left(\, \text{logit}\left(\mu_{c[p]}\right) + m_i \log\left(\iota_{c[p]}\right) \;,\; \sigma_{c[p]}^{2} \,\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.980548em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.80002em;vertical-align:-.65002em"></span><span class="mord text"><span class="mord">Logitnormal</span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size2">(</span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord text"><span class="mord">logit</span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.34480000000000005em"><span style="top:-2.5198em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mopen mtight">[</span><span class="mord mathnormal mtight">p</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.3551999999999999em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop">lo<span style="margin-right:.01389em">g</span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal">ι</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.34480000000000005em"><span style="top:-2.5198em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mopen mtight">[</span><span class="mord mathnormal mtight">p</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.3551999999999999em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-2.428em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mopen mtight">[</span><span class="mord mathnormal mtight">p</span><span class="mclose mtight">]</span></span></span></span><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4469999999999999em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size2">)</span></span></span></span></span></span></span></p><p>Modeling policy interventions in this way allows for a clear-cut interpretation of the intervention effect parameter. More specifically, with a little algebra, it becomes evident that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ι</mi><mrow><mi>c</mi><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo></mrow></msub></mrow><annotation encoding="application/x-tex">\iota_{c[p]}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7857599999999999em;vertical-align:-.3551999999999999em"></span><span class="mord"><span class="mord mathnormal">ι</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.34480000000000005em"><span style="top:-2.5198em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mopen mtight">[</span><span class="mord mathnormal mtight">p</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.3551999999999999em"><span></span></span></span></span></span></span></span></span></span> essentially acts as a multiplier effect on the average class transmission odds:</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>log</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mfrac><msub><mi>μ</mi><mrow><mi>c</mi><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo></mrow></msub><mrow><mn>1</mn><mo>−</mo><msub><mi>μ</mi><mrow><mi>c</mi><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo></mrow></msub></mrow></mfrac><mo fence="true">)</mo></mrow><mo>→</mo><mi>log</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><msub><mi>ι</mi><mrow><mi>c</mi><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo></mrow></msub><mfrac><msub><mi>μ</mi><mrow><mi>c</mi><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo></mrow></msub><mrow><mn>1</mn><mo>−</mo><msub><mi>μ</mi><mrow><mi>c</mi><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo></mrow></msub></mrow></mfrac><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\log\left(\frac{\mu_{c[p]}}{1-\mu_{c[p]}} \right) \rightarrow \log\left(\iota_{c[p]} \frac{\mu_{c[p]}}{1-\mu_{c[p]}} \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.4912em;vertical-align:-1.0412em"></span><span class="mop">lo<span style="margin-right:.01389em">g</span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.17576em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.34480000000000005em"><span style="top:-2.5198em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mopen mtight">[</span><span class="mord mathnormal mtight">p</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.3551999999999999em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.7451999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.34480000000000005em"><span style="top:-2.5198em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mopen mtight">[</span><span class="mord mathnormal mtight">p</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.3551999999999999em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0412em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.4912em;vertical-align:-1.0412em"></span><span class="mop">lo<span style="margin-right:.01389em">g</span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mord mathnormal">ι</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.34480000000000005em"><span style="top:-2.5198em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mopen mtight">[</span><span class="mord mathnormal mtight">p</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.3551999999999999em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.17576em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.34480000000000005em"><span style="top:-2.5198em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mopen mtight">[</span><span class="mord mathnormal mtight">p</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.3551999999999999em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.7451999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.34480000000000005em"><span style="top:-2.5198em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mopen mtight">[</span><span class="mord mathnormal mtight">p</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.3551999999999999em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0412em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size3">)</span></span></span></span></span></span></span></p><h2 id="Simulating-our-data">Simulating our data</h2><h3 id="Metadata">Metadata</h3><p>In order to be test out this model, the following metadata must be defined in relation to the application context:</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>:</mo></mrow><annotation encoding="application/x-tex">P:</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.13889em">P</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">:</span></span></span></span> A vector containing the number of settings per class</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>:</mo></mrow><annotation encoding="application/x-tex">K:</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.07153em">K</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">:</span></span></span></span> The number of setting classes considered in the model</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>:</mo></mrow><annotation encoding="application/x-tex">N:</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">:</span></span></span></span> The total population</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>:</mo></mrow><annotation encoding="application/x-tex">S:</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.05764em">S</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">:</span></span></span></span> The number of random surveys sent out</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>:</mo></mrow><annotation encoding="application/x-tex">T:</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">:</span></span></span></span> The total number of T&amp;T samples</li></ul><p>In particular, it is worth highlighting that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo separator="true">,</mo><mi>S</mi><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">N,S,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8777699999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:.05764em">S</span><span class="mpunct">,</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span></span></span></span> are constrained by the following:</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>N</mi><mo>≥</mo><mi>S</mi><mo>+</mo><mi>T</mi></mrow><annotation encoding="application/x-tex">N \geq S+T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8193em;vertical-align:-.13597em"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.76666em;vertical-align:-.08333em"></span><span class="mord mathnormal" style="margin-right:.05764em">S</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span></span></span></span></span></p><p>It is assumed that, in the typical case, both <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span></span></span></span> are predetermined, and the authority applying the model gets to choose <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.05764em">S</span></span></span></span> subject to the above. In our simulation, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.05764em">S</span></span></span></span> are pre-set and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span></span></span></span> is randomly determined given the simulated testing rates.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#### METADATA ####</span></span><br><span class="line">P = [<span class="number">3</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>]    <span class="comment"># Number of settings per class </span></span><br><span class="line">N = <span class="number">10000</span>                          <span class="comment"># Total population</span></span><br><span class="line">S = <span class="number">8000</span>                           <span class="comment"># Number of random surveys sent out</span></span><br><span class="line">SEED = <span class="number">1729</span>                        <span class="comment"># Random seed</span></span><br></pre></td></tr></table></figure><h3 id="Population-ground-truth">Population ground truth</h3><p>Since we our data collection strategy is (an ideal) hypothetical, to test our model we must first specify a ground truth for the population parameters and then simulate our data accordingly. To this end we sampled our population parameters as follows, making sure to try a range of values for these to ensure model robustness:</p><table><thead><tr><th>Parameter</th><th>Model Notation</th><th>Simulation</th><th>Model Priors</th></tr></thead><tbody><tr><td>Setting transmission rates</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mrow><mi>i</mi><mi>p</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\theta_{ip}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.980548em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span></td><td>Logit-normal distribution parameterized by class transmission rate mean and variance</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">U(0,1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.10903em">U</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></td></tr><tr><td>Mean class transmission rates</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mrow><mi>c</mi><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo></mrow></msub></mrow><annotation encoding="application/x-tex">\mu_{c[p]}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7857599999999999em;vertical-align:-.3551999999999999em"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.34480000000000005em"><span style="top:-2.5198em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mopen mtight">[</span><span class="mord mathnormal mtight">p</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.3551999999999999em"><span></span></span></span></span></span></span></span></span></span></td><td>Beta distribution</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">U(0,1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.10903em">U</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></td></tr><tr><td>Class transmission rate variance</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>σ</mi><mrow><mi>c</mi><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo></mrow><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\sigma^2_{c[p]}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3111079999999997em;vertical-align:-.49699999999999994em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8141079999999998em"><span style="top:-2.378em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mopen mtight">[</span><span class="mord mathnormal mtight">p</span><span class="mclose mtight">]</span></span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.49699999999999994em"><span></span></span></span></span></span></span></span></span></span></td><td>Inverse gamma distribution</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Inv-Gamma</mtext><mo stretchy="false">(</mo><mn>10</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{Inv-Gamma}(10, 1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord text"><span class="mord">Inv-Gamma</span></span><span class="mopen">(</span><span class="mord">1</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></td></tr><tr><td>Base transmission rate</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi></mrow><annotation encoding="application/x-tex">\rho</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathnormal">ρ</span></span></span></span></td><td>Beta distribution</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">U(0,1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.10903em">U</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></td></tr><tr><td>Class-specific mask impact</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ι</mi><mrow><mi>c</mi><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo></mrow></msub></mrow><annotation encoding="application/x-tex">\iota_{c[p]}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7857599999999999em;vertical-align:-.3551999999999999em"></span><span class="mord"><span class="mord mathnormal">ι</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.34480000000000005em"><span style="top:-2.5198em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mopen mtight">[</span><span class="mord mathnormal mtight">p</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.3551999999999999em"><span></span></span></span></span></span></span></span></span></span></td><td>Normal with negative mean</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{N}(-1, 1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathcal" style="margin-right:.14736em">N</span></span><span class="mopen">(</span><span class="mord">−</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></td></tr><tr><td>Testing rates</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>γ</mi><mrow><mo>+</mo><mo separator="true">,</mo><mtext> </mtext><mo>−</mo></mrow></msub></mrow><annotation encoding="application/x-tex">\gamma_{+,\,-}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.716668em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05556em">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.25833100000000003em"><span style="top:-2.5500000000000003em;margin-left:-.05556em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">+</span><span class="mpunct mtight">,</span><span class="mspace mtight" style="margin-right:.19516666666666668em"></span><span class="mord mtight">−</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span></td><td>Beta distribution</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">U(0,1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.10903em">U</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></td></tr><tr><td>Test precision and recall rates</td><td>$\lambda_{+,,-} $</td><td>Beta distribution</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Beta</mtext><mo stretchy="false">(</mo><mi>α</mi><mo>∗</mo><mo separator="true">,</mo><mi>β</mi><mo>∗</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{Beta}(\alpha*, \beta*)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord text"><span class="mord">Beta</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.0037em">α</span><span class="mord">∗</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:.05278em">β</span><span class="mord">∗</span><span class="mclose">)</span></span></span></span>, with shape hyperparameters calibrated to match the antigen test sensitivity and specificity results from the <a href="https://www.ox.ac.uk/sites/files/oxford/media_wysiwyg/UK%20evaluation_PHE%20Porton%20Down%20%20University%20of%20Oxford_final.pdf" target="_blank" rel="noopener">Joint PHE Porton Down &amp; University of Oxford SARS-CoV-2 test development and validation cell</a></td></tr></tbody></table><h2 id="Fitting-our-Model">Fitting our Model</h2><h3 id="Our-model-in-Stan">Our model in Stan</h3><p>We implemented the code for our first-principles model using Stan, a probabilistic inference language compiled in C++. Stan allows users to carry out full Bayesian inference on statistical models via Markov Chain Monte Carlo (MCMC) sampling, and enables model specification in a block-like fashion. The main building blocks for our Stan model are:</p><ol><li>The data block, which specifies the type and dimensions of data used to train the model.</li><li>The parameter block, which specifies all underlying statistical parameters of the model.</li><li>The model block, which assigns parameter priors and constructs the model likelihood describing the joint probability of the observed data as a function of the parameters.</li></ol><p>With computational feasibility in mind, we also coded a version of our model using the TensorFlow Probability framework, as this version supports the use of GPU’s and distributed computing capabilities to deliver greater computational power. For a more extensive review of the code produced, please refer to the project <a href="https://github.com/THargreaves/reinventing-test-and-trace" target="_blank" rel="noopener">GitHub repository.</a></p><figure class="highlight stan"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line">model_code = <span class="string">""</span><span class="string">"</span></span><br><span class="line"><span class="string">functions &#123;</span></span><br><span class="line"><span class="string">  real expit_gaussian_lpdf(real y, real logit_mu, real sigma2) &#123;</span></span><br><span class="line"><span class="string">    return log(1 / y + 1 / (1 - y)) - (logit(y) - logit_mu)^2 / (2 * sigma2);</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">data &#123;</span></span><br><span class="line"><span class="string">  int&lt;lower=0&gt; T;                            // number of T&amp;T observations</span></span><br><span class="line"><span class="string">  int&lt;lower=0&gt; S;                            // number of survey observations</span></span><br><span class="line"><span class="string">  int&lt;lower=0&gt; P;                            // number of settings</span></span><br><span class="line"><span class="string">  int&lt;lower=0&gt; K;                            // number of classes</span></span><br><span class="line"><span class="string">  int&lt;lower=0, upper=1&gt; X[T,P];              // activity occurrences</span></span><br><span class="line"><span class="string">  int&lt;lower=0, upper=1&gt; y[T];                // transmission (tested positive)</span></span><br><span class="line"><span class="string">  int&lt;lower=0, upper=1&gt; survey[S,P];         // activity occurrences of surveyed individuals</span></span><br><span class="line"><span class="string">  real lambda_prior_params[2,2];             // shape parameters for TP/TN test rate priors</span></span><br><span class="line"><span class="string">  int&lt;lower=1, upper=K&gt; c[P];                // setting classes</span></span><br><span class="line"><span class="string">  int&lt;lower=0, upper=1&gt; m[T];                // masking-wearing</span></span><br><span class="line"><span class="string">  int&lt;lower=0, upper=1&gt; m_survey[S];         // masking-wearing</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">parameters &#123;</span></span><br><span class="line"><span class="string">  real&lt;lower=0, upper=1&gt; theta[P];           // transmission rates</span></span><br><span class="line"><span class="string">  real&lt;lower=0, upper=1&gt; mu[K];              // class transmission means</span></span><br><span class="line"><span class="string">  real&lt;lower=0&gt; sigma2[K];                   // class transmission variances</span></span><br><span class="line"><span class="string">  real&lt;lower=0, upper=1&gt; gamma[2];           // Testing rates, given infected status [s|w , s|!w]</span></span><br><span class="line"><span class="string">  real&lt;lower=0, upper=1&gt; lambda[2];          // True positive and true negative rates of tests [TP,TN]</span></span><br><span class="line"><span class="string">  real&lt;lower=0, upper=1&gt; rho;                // underlying risk</span></span><br><span class="line"><span class="string">  real iota[K];                              // intervention impacts (log)</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">transformed parameters &#123;</span></span><br><span class="line"><span class="string">  // Pre-computation for efficiency</span></span><br><span class="line"><span class="string">  real log1m_theta[P] = log1m(theta);</span></span><br><span class="line"><span class="string">  real log1m_theta_int[P];</span></span><br><span class="line"><span class="string">  real log1m_rho = log1m(rho);</span></span><br><span class="line"><span class="string">  real logit_mu[K] = logit(mu);</span></span><br><span class="line"><span class="string">  real log_gamma[2];</span></span><br><span class="line"><span class="string">  real log1m_gamma[2];</span></span><br><span class="line"><span class="string">  real log_lambda[2];</span></span><br><span class="line"><span class="string">  real log1m_lambda[2];</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  for (p in 1:P) &#123;</span></span><br><span class="line"><span class="string">    log1m_theta_int[p] = log1m_inv_logit(logit(theta[p]) + iota[c[p]]);</span></span><br><span class="line"><span class="string">  &#125; </span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  log1m_theta = log1m(theta); </span></span><br><span class="line"><span class="string">  log_gamma = log(gamma);</span></span><br><span class="line"><span class="string">  log1m_gamma = log1m(gamma);</span></span><br><span class="line"><span class="string">  log_lambda = log(lambda);</span></span><br><span class="line"><span class="string">  log1m_lambda = log1m(lambda);</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">model &#123;</span></span><br><span class="line"><span class="string">  // Priors</span></span><br><span class="line"><span class="string">  //mu ~ beta(1, 5);</span></span><br><span class="line"><span class="string">  mu ~ uniform(0, 1);</span></span><br><span class="line"><span class="string">  sigma2 ~ inv_gamma(10, 1);</span></span><br><span class="line"><span class="string">  rho ~ beta(1, 3);</span></span><br><span class="line"><span class="string">  iota ~ normal(-1, 1);</span></span><br><span class="line"><span class="string">  gamma ~ uniform(0, 1);</span></span><br><span class="line"><span class="string">  lambda[1] ~ beta(lambda_prior_params[1,1],lambda_prior_params[1,2]);</span></span><br><span class="line"><span class="string">  lambda[2] ~ beta(lambda_prior_params[2,1],lambda_prior_params[2,2]);</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  // Likelihood (classes)</span></span><br><span class="line"><span class="string">  for (p in 1:P) &#123;</span></span><br><span class="line"><span class="string">    theta[p] ~ expit_gaussian(logit_mu[c[p]], sigma2[c[p]]);</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  // Likelihood (survey)</span></span><br><span class="line"><span class="string">  for (n in 1:S) &#123;</span></span><br><span class="line"><span class="string">    real s = 0.0;</span></span><br><span class="line"><span class="string">    for (p in 1:P) &#123;</span></span><br><span class="line"><span class="string">      if (survey[n,p] == 1) &#123;</span></span><br><span class="line"><span class="string">        if (m_survey[n] == 1) &#123;</span></span><br><span class="line"><span class="string">          s += log1m_theta_int[p];</span></span><br><span class="line"><span class="string">        &#125; else &#123;</span></span><br><span class="line"><span class="string">          s += log1m_theta[p];</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">      &#125;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    s += log1m_rho;</span></span><br><span class="line"><span class="string">    target += log_sum_exp((log1m_exp(s)+log1m_gamma[1]), (s+log1m_gamma[2]));</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">  // Likelihood (T&amp;T observations)</span></span><br><span class="line"><span class="string">  for (n in 1:T) &#123;</span></span><br><span class="line"><span class="string">    real s = 0.0;</span></span><br><span class="line"><span class="string">    for (p in 1:P) &#123;</span></span><br><span class="line"><span class="string">      if (X[n,p] == 1) &#123;</span></span><br><span class="line"><span class="string">        if (m[n] == 1) &#123;</span></span><br><span class="line"><span class="string">          s += log1m_theta_int[p];</span></span><br><span class="line"><span class="string">        &#125; else &#123;</span></span><br><span class="line"><span class="string">          s += log1m_theta[p];</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">      &#125;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    s += log1m_rho;</span></span><br><span class="line"><span class="string">    if (y[n] == 1) &#123;</span></span><br><span class="line"><span class="string">      target += log_sum_exp((log1m_exp(s) + log_gamma[1] + log_lambda[1]), (s + log_gamma[2] + log1m_lambda[2]));</span></span><br><span class="line"><span class="string">    &#125; else &#123;</span></span><br><span class="line"><span class="string">      target += log_sum_exp((s + log_gamma[2] + log_lambda[2]), (log1m_exp(s) + log_gamma[1] + log1m_lambda[1]));</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">"</span><span class="string">""</span></span><br></pre></td></tr></table></figure><h3 id="Markov-Chain-Monte-Carlo-Posterior-Sampling">Markov Chain Monte Carlo Posterior Sampling</h3><p>In general, the aim of Bayesian inference is to derive the posterior distribution of our parameters by defining it mathematically using Bayes’ theorem as below, where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(\theta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.02778em">θ</span><span class="mclose">)</span></span></span></span> is the parameter prior and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">X</mi><mtext> </mtext><mi mathvariant="normal">∣</mi><mtext> </mtext><mi>θ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(\boldsymbol{X}\,|\,\theta )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:.07778em">X</span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">∣</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:.02778em">θ</span><span class="mclose">)</span></span></span></span> is the model likelihood:</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>θ</mi><mtext> </mtext><mi mathvariant="normal">∣</mi><mtext> </mtext><mi mathvariant="bold-italic">X</mi><mo stretchy="false">)</mo><mtext>  </mtext><mo>=</mo><mtext>  </mtext><mfrac><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mtext> </mtext><mi>p</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">X</mi><mtext> </mtext><mi mathvariant="normal">∣</mi><mtext> </mtext><mi>θ</mi><mo stretchy="false">)</mo></mrow><mrow><mi>p</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">X</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">p(\theta \,|\,\boldsymbol{X}) \;=\; \frac{p(\theta) \, p(\boldsymbol{X}\,|\,\theta )}{p( \boldsymbol{X})}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.02778em">θ</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">∣</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:.07778em">X</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-.936em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:.07778em">X</span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.02778em">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:.07778em">X</span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">∣</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:.02778em">θ</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.936em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>Unfortunately, this distribution in our model (as is the case for most Bayesian models) cannot be evaluated analytically given the highly-dimensional parameter space. To overcome this, Stan utilizes the NUTS algorithm (part of the general class of MCMC methods) to infer the posterior distribution by repeatedly drawing samples from it, even though its full closed-form characterization is unknown. Unlike regular Monte Carlo sampling, which draws independent samples, MCMC allows for ‘smarter’ sampling as it draws correlated samples from the stationary distribution of a Markov chain that’s proportional to the desired distribution. This allows for the sampling process to enter regions of high density much faster. For more details regarding how Stan achieves this using the NUTS algorithm, the interested reader should refer to <a href="https://mc-stan.org/docs/2_18/reference-manual/hmc-chapter.html" target="_blank" rel="noopener">this link.</a></p><p>At its core, there are three hyperparamters that need to be specified for MCMC sampling with the NUTS algorithm.<br>Firstly, the <code>num_warmup</code> parameter is used to specify the number of samples that are discarded as burn-in. This is done in order to allow convergence onto the stationary distribution of the Markov chain. Secondly, the <code>n_samples</code> parameter specifies the number of samples to be drawn from the distribution. Finally, <code>n_chains</code> specifies the number of chains that should be constructed, as using more well-mixed chains increases robustness.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### MCMC SAMPLING HYPERPARAMETERS ####</span></span><br><span class="line">ITER = <span class="number">1000</span></span><br><span class="line">WARMUP = <span class="number">500</span></span><br><span class="line">CHAINS = <span class="number">8</span></span><br><span class="line">SEED = <span class="number">1729</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#### MODEL FITTING ####</span></span><br><span class="line"><span class="comment"># Define model data</span></span><br><span class="line">model_data = &#123;</span><br><span class="line">    <span class="string">'T'</span>: T, <span class="string">'S'</span>: S, <span class="string">'P'</span>: sum(P), <span class="string">'K'</span>: len(P),</span><br><span class="line">    <span class="string">'X'</span>: X.to_numpy(), <span class="string">'y'</span>: y.to_numpy(), <span class="string">'c'</span>: c, <span class="string">'m'</span>: m, <span class="string">'m_survey'</span>: m_survey,</span><br><span class="line">    <span class="string">'survey'</span>: X_survey.to_numpy(), <span class="string">'lambda_prior_params'</span>:prior_params,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Compile model</span></span><br><span class="line">posterior = stan.build(model_code, data=model_data, random_seed=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Fit model</span></span><br><span class="line">fit = posterior.sample(num_samples=ITER, num_warmup=WARMUP, num_chains=CHAINS)</span><br></pre></td></tr></table></figure><h2 id="Results-and-conclusion">Results and conclusion</h2><h3 id="Visualizing-posterior-samples">Visualizing posterior samples</h3><p>After running our model, we computed the summary statistics of our posterior samples in the table below. Additionally, we visualize these in the subsequent traceplots, which show the distributions for all <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.13889em">P</span></span></span></span> setting transmission rates, as well as the other model parameters, in the left, and the sampled values on the right. Overall, we can see that there was proper chain mixing given both the shape of our sampled value traces and the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>R</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.9467699999999999em;vertical-align:0"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9467699999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.00773em">R</span></span></span><span style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em"><span class="mord">^</span></span></span></span></span></span></span></span></span></span> statistics (equal to one for all model parameters), which suggests that improper model parametrization is unlikely to be an issue.</p><table><thead><tr><th></th><th>mean</th><th>sd</th><th>hdi_3%</th><th>hdi_97%</th><th>mcse_mean</th><th>mcse_sd</th><th>ess_mean</th><th>ess_sd</th><th>ess_bulk</th><th>ess_tail</th><th>r_hat</th></tr></thead><tbody><tr><th>theta[0]</th><td>0.250</td><td>0.111</td><td>0.042</td><td>0.444</td><td>0.002</td><td>0.001</td><td>4090.0</td><td>4090.0</td><td>3711.0</td><td>3200.0</td><td>1.0</td></tr><tr><th>theta[1]</th><td>0.224</td><td>0.101</td><td>0.042</td><td>0.410</td><td>0.002</td><td>0.001</td><td>4116.0</td><td>4116.0</td><td>3688.0</td><td>3103.0</td><td>1.0</td></tr><tr><th>theta[2]</th><td>0.212</td><td>0.098</td><td>0.040</td><td>0.390</td><td>0.001</td><td>0.001</td><td>4352.0</td><td>4352.0</td><td>3834.0</td><td>3492.0</td><td>1.0</td></tr><tr><th>theta[3]</th><td>0.228</td><td>0.098</td><td>0.053</td><td>0.404</td><td>0.002</td><td>0.001</td><td>2733.0</td><td>2733.0</td><td>2720.0</td><td>3567.0</td><td>1.0</td></tr><tr><th>theta[4]</th><td>0.231</td><td>0.099</td><td>0.066</td><td>0.420</td><td>0.002</td><td>0.001</td><td>2788.0</td><td>2787.0</td><td>2807.0</td><td>3854.0</td><td>1.0</td></tr><tr><th>theta[5]</th><td>0.223</td><td>0.097</td><td>0.062</td><td>0.410</td><td>0.002</td><td>0.001</td><td>2890.0</td><td>2877.0</td><td>2818.0</td><td>3744.0</td><td>1.0</td></tr><tr><th>theta[6]</th><td>0.267</td><td>0.108</td><td>0.080</td><td>0.471</td><td>0.002</td><td>0.001</td><td>2956.0</td><td>2956.0</td><td>2817.0</td><td>3703.0</td><td>1.0</td></tr><tr><th>theta[7]</th><td>0.262</td><td>0.110</td><td>0.076</td><td>0.470</td><td>0.002</td><td>0.002</td><td>2323.0</td><td>2323.0</td><td>2254.0</td><td>3422.0</td><td>1.0</td></tr><tr><th>theta[8]</th><td>0.189</td><td>0.127</td><td>0.000</td><td>0.408</td><td>0.002</td><td>0.001</td><td>5756.0</td><td>5756.0</td><td>4251.0</td><td>2878.0</td><td>1.0</td></tr><tr><th>theta[9]</th><td>0.314</td><td>0.088</td><td>0.153</td><td>0.476</td><td>0.001</td><td>0.001</td><td>4434.0</td><td>4431.0</td><td>4447.0</td><td>5614.0</td><td>1.0</td></tr><tr><th>theta[10]</th><td>0.322</td><td>0.092</td><td>0.154</td><td>0.495</td><td>0.001</td><td>0.001</td><td>4290.0</td><td>4290.0</td><td>4273.0</td><td>5728.0</td><td>1.0</td></tr><tr><th>theta[11]</th><td>0.282</td><td>0.085</td><td>0.131</td><td>0.437</td><td>0.001</td><td>0.001</td><td>4411.0</td><td>4323.0</td><td>4461.0</td><td>5124.0</td><td>1.0</td></tr><tr><th>theta[12]</th><td>0.304</td><td>0.087</td><td>0.150</td><td>0.470</td><td>0.001</td><td>0.001</td><td>4219.0</td><td>4200.0</td><td>4279.0</td><td>5716.0</td><td>1.0</td></tr><tr><th>theta[13]</th><td>0.223</td><td>0.146</td><td>0.000</td><td>0.476</td><td>0.002</td><td>0.001</td><td>6577.0</td><td>6577.0</td><td>5525.0</td><td>4074.0</td><td>1.0</td></tr><tr><th>theta[14]</th><td>0.210</td><td>0.111</td><td>0.021</td><td>0.414</td><td>0.002</td><td>0.001</td><td>4139.0</td><td>4139.0</td><td>3687.0</td><td>3482.0</td><td>1.0</td></tr><tr><th>theta[15]</th><td>0.236</td><td>0.122</td><td>0.028</td><td>0.458</td><td>0.002</td><td>0.001</td><td>4540.0</td><td>4540.0</td><td>4006.0</td><td>3202.0</td><td>1.0</td></tr><tr><th>theta[16]</th><td>0.133</td><td>0.103</td><td>0.000</td><td>0.318</td><td>0.001</td><td>0.001</td><td>6605.0</td><td>6605.0</td><td>4609.0</td><td>2862.0</td><td>1.0</td></tr><tr><th>theta[17]</th><td>0.207</td><td>0.128</td><td>0.001</td><td>0.430</td><td>0.002</td><td>0.001</td><td>4882.0</td><td>4882.0</td><td>3842.0</td><td>2402.0</td><td>1.0</td></tr><tr><th>theta[18]</th><td>0.222</td><td>0.105</td><td>0.043</td><td>0.415</td><td>0.002</td><td>0.001</td><td>3161.0</td><td>3161.0</td><td>3078.0</td><td>4504.0</td><td>1.0</td></tr><tr><th>theta[19]</th><td>0.230</td><td>0.109</td><td>0.046</td><td>0.428</td><td>0.002</td><td>0.001</td><td>3269.0</td><td>3269.0</td><td>3178.0</td><td>4160.0</td><td>1.0</td></tr><tr><th>theta[20]</th><td>0.189</td><td>0.090</td><td>0.037</td><td>0.353</td><td>0.001</td><td>0.001</td><td>3694.0</td><td>3694.0</td><td>3518.0</td><td>4593.0</td><td>1.0</td></tr><tr><th>theta[21]</th><td>0.215</td><td>0.102</td><td>0.045</td><td>0.408</td><td>0.002</td><td>0.001</td><td>3363.0</td><td>3363.0</td><td>3232.0</td><td>4370.0</td><td>1.0</td></tr><tr><th>rho</th><td>0.211</td><td>0.064</td><td>0.087</td><td>0.332</td><td>0.001</td><td>0.001</td><td>5180.0</td><td>5180.0</td><td>5262.0</td><td>3748.0</td><td>1.0</td></tr><tr><th>mu[0]</th><td>0.230</td><td>0.100</td><td>0.053</td><td>0.419</td><td>0.002</td><td>0.001</td><td>3899.0</td><td>3899.0</td><td>3493.0</td><td>2856.0</td><td>1.0</td></tr><tr><th>mu[1]</th><td>0.241</td><td>0.093</td><td>0.080</td><td>0.418</td><td>0.002</td><td>0.001</td><td>2338.0</td><td>2338.0</td><td>2262.0</td><td>3169.0</td><td>1.0</td></tr><tr><th>mu[2]</th><td>0.202</td><td>0.138</td><td>0.000</td><td>0.447</td><td>0.002</td><td>0.001</td><td>5961.0</td><td>5961.0</td><td>4364.0</td><td>2970.0</td><td>1.0</td></tr><tr><th>mu[3]</th><td>0.307</td><td>0.080</td><td>0.164</td><td>0.455</td><td>0.001</td><td>0.001</td><td>3525.0</td><td>3512.0</td><td>3531.0</td><td>4945.0</td><td>1.0</td></tr><tr><th>mu[4]</th><td>0.234</td><td>0.154</td><td>0.000</td><td>0.504</td><td>0.002</td><td>0.001</td><td>6848.0</td><td>6848.0</td><td>5735.0</td><td>3834.0</td><td>1.0</td></tr><tr><th>mu[5]</th><td>0.228</td><td>0.117</td><td>0.027</td><td>0.444</td><td>0.002</td><td>0.001</td><td>4374.0</td><td>4374.0</td><td>3914.0</td><td>3227.0</td><td>1.0</td></tr><tr><th>mu[6]</th><td>0.145</td><td>0.114</td><td>0.000</td><td>0.351</td><td>0.001</td><td>0.001</td><td>7078.0</td><td>7078.0</td><td>4699.0</td><td>2933.0</td><td>1.0</td></tr><tr><th>mu[7]</th><td>0.219</td><td>0.139</td><td>0.000</td><td>0.460</td><td>0.002</td><td>0.001</td><td>5242.0</td><td>5242.0</td><td>4052.0</td><td>2295.0</td><td>1.0</td></tr><tr><th>mu[8]</th><td>0.214</td><td>0.096</td><td>0.051</td><td>0.391</td><td>0.002</td><td>0.001</td><td>3137.0</td><td>3137.0</td><td>3025.0</td><td>3789.0</td><td>1.0</td></tr><tr><th>sigma2[0]</th><td>0.131</td><td>0.051</td><td>0.056</td><td>0.220</td><td>0.001</td><td>0.000</td><td>7513.0</td><td>5708.0</td><td>10852.0</td><td>5458.0</td><td>1.0</td></tr><tr><th>sigma2[1]</th><td>0.150</td><td>0.062</td><td>0.061</td><td>0.260</td><td>0.001</td><td>0.001</td><td>6404.0</td><td>5250.0</td><td>8836.0</td><td>5385.0</td><td>1.0</td></tr><tr><th>sigma2[2]</th><td>0.118</td><td>0.043</td><td>0.053</td><td>0.193</td><td>0.000</td><td>0.000</td><td>8280.0</td><td>6082.0</td><td>12257.0</td><td>5441.0</td><td>1.0</td></tr><tr><th>sigma2[3]</th><td>0.135</td><td>0.053</td><td>0.059</td><td>0.226</td><td>0.001</td><td>0.001</td><td>7057.0</td><td>5298.0</td><td>10888.0</td><td>5228.0</td><td>1.0</td></tr><tr><th>sigma2[4]</th><td>0.117</td><td>0.043</td><td>0.054</td><td>0.196</td><td>0.000</td><td>0.000</td><td>9024.0</td><td>6569.0</td><td>13371.0</td><td>5450.0</td><td>1.0</td></tr><tr><th>sigma2[5]</th><td>0.125</td><td>0.048</td><td>0.054</td><td>0.211</td><td>0.001</td><td>0.000</td><td>8224.0</td><td>6024.0</td><td>12240.0</td><td>5518.0</td><td>1.0</td></tr><tr><th>sigma2[6]</th><td>0.118</td><td>0.043</td><td>0.056</td><td>0.200</td><td>0.000</td><td>0.000</td><td>8184.0</td><td>5615.0</td><td>13440.0</td><td>5532.0</td><td>1.0</td></tr><tr><th>sigma2[7]</th><td>0.118</td><td>0.043</td><td>0.055</td><td>0.198</td><td>0.000</td><td>0.000</td><td>7992.0</td><td>5761.0</td><td>12288.0</td><td>4824.0</td><td>1.0</td></tr><tr><th>sigma2[8]</th><td>0.138</td><td>0.052</td><td>0.058</td><td>0.232</td><td>0.001</td><td>0.000</td><td>7786.0</td><td>6455.0</td><td>9620.0</td><td>5729.0</td><td>1.0</td></tr><tr><th>iota[0]</th><td>-0.954</td><td>0.619</td><td>-2.131</td><td>0.208</td><td>0.008</td><td>0.006</td><td>5775.0</td><td>5775.0</td><td>5852.0</td><td>4816.0</td><td>1.0</td></tr><tr><th>iota[1]</th><td>-1.256</td><td>0.566</td><td>-2.343</td><td>-0.197</td><td>0.009</td><td>0.006</td><td>4263.0</td><td>4263.0</td><td>4302.0</td><td>4532.0</td><td>1.0</td></tr><tr><th>iota[2]</th><td>-1.390</td><td>0.864</td><td>-2.993</td><td>0.262</td><td>0.009</td><td>0.007</td><td>9762.0</td><td>8061.0</td><td>9793.0</td><td>6472.0</td><td>1.0</td></tr><tr><th>iota[3]</th><td>-1.571</td><td>0.429</td><td>-2.392</td><td>-0.812</td><td>0.006</td><td>0.004</td><td>5454.0</td><td>5227.0</td><td>5576.0</td><td>5157.0</td><td>1.0</td></tr><tr><th>iota[4]</th><td>-1.163</td><td>0.866</td><td>-2.829</td><td>0.437</td><td>0.008</td><td>0.007</td><td>10823.0</td><td>7689.0</td><td>10823.0</td><td>6792.0</td><td>1.0</td></tr><tr><th>iota[5]</th><td>-0.620</td><td>0.734</td><td>-2.014</td><td>0.734</td><td>0.009</td><td>0.007</td><td>5981.0</td><td>4847.0</td><td>6037.0</td><td>5498.0</td><td>1.0</td></tr><tr><th>iota[6]</th><td>-1.295</td><td>0.875</td><td>-2.947</td><td>0.376</td><td>0.009</td><td>0.007</td><td>10158.0</td><td>7307.0</td><td>10212.0</td><td>6283.0</td><td>1.0</td></tr><tr><th>iota[7]</th><td>-1.039</td><td>0.850</td><td>-2.644</td><td>0.550</td><td>0.009</td><td>0.007</td><td>9000.0</td><td>6438.0</td><td>9066.0</td><td>6105.0</td><td>1.0</td></tr><tr><th>iota[8]</th><td>-0.505</td><td>0.599</td><td>-1.628</td><td>0.633</td><td>0.009</td><td>0.006</td><td>4381.0</td><td>4381.0</td><td>4388.0</td><td>4901.0</td><td>1.0</td></tr><tr><th>gamma[0]</th><td>0.461</td><td>0.018</td><td>0.429</td><td>0.497</td><td>0.000</td><td>0.000</td><td>2755.0</td><td>2747.0</td><td>2819.0</td><td>3925.0</td><td>1.0</td></tr><tr><th>gamma[1]</th><td>0.191</td><td>0.015</td><td>0.162</td><td>0.219</td><td>0.000</td><td>0.000</td><td>10384.0</td><td>10364.0</td><td>10370.0</td><td>5707.0</td><td>1.0</td></tr><tr><th>lambda[0]</th><td>0.747</td><td>0.020</td><td>0.712</td><td>0.785</td><td>0.000</td><td>0.000</td><td>3566.0</td><td>3554.0</td><td>3625.0</td><td>5333.0</td><td>1.0</td></tr><tr><th>lambda[1]</th><td>0.997</td><td>0.001</td><td>0.996</td><td>0.998</td><td>0.000</td><td>0.000</td><td>15214.0</td><td>15214.0</td><td>15246.0</td><td>5420.0</td><td>1.0</td></tr></tbody></table><p><img src="/" class="lazyload" data-src="/images/track-and-trace/track-and-trace_26_0.png" alt=""></p><h3 id="Comparison-with-ground-truth">Comparison with ground truth</h3><p>After fitting, one key question is the extent to which our model is successful in estimating the underlying transmission rates. To test this, we take the posterior mean as the <a href="https://en.wikipedia.org/wiki/Bayes_estimator" target="_blank" rel="noopener">minimum mean squared error estimate</a> and compare it to the ground-truth parameters used to simulate the data-generating process. As shown in the table below, most parameter estimates fall reasonably close from the actual ground truth values, and all of them fall within the 94% high density interval (HDI), serving as a good indicator of our model’s accuracy.</p><p>The key condition for this comparison as proof-of-concept is the fact that our model only observes the parameter priors and the training data, but never the simulating distributions themselves. Moreover, excluding the case of antigen test accuracy rates, the priors as specifically chosen to be largely uninformative relative to the simulating distribution in order to limit the unreasonable influence of these on model performance.</p><p>Finally, a question of interest is how the accuracy of the model is affected by the number of training samples or the dimension of the parameter space. The results for both of these questions are excluded for brevity, but they tend to fall in line with what would be expected (model accuracy increases with training data and decreases with dimensionality) and the interested reader should consult the project repository for more details.</p><table><thead><tr><th></th><th>Ground Truth</th><th>Posterior Mean</th><th>HDI 3%</th><th>HDI 97%</th></tr><tr><th>Parameter</th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><th>theta[0]</th><td>0.125388</td><td>0.250</td><td>0.042</td><td>0.444</td></tr><tr><th>theta[1]</th><td>0.129571</td><td>0.224</td><td>0.042</td><td>0.410</td></tr><tr><th>theta[2]</th><td>0.127706</td><td>0.212</td><td>0.040</td><td>0.390</td></tr><tr><th>theta[3]</th><td>0.121898</td><td>0.228</td><td>0.053</td><td>0.404</td></tr><tr><th>theta[4]</th><td>0.141731</td><td>0.231</td><td>0.066</td><td>0.420</td></tr><tr><th>theta[5]</th><td>0.141376</td><td>0.223</td><td>0.062</td><td>0.410</td></tr><tr><th>theta[6]</th><td>0.116330</td><td>0.267</td><td>0.080</td><td>0.471</td></tr><tr><th>theta[7]</th><td>0.140423</td><td>0.262</td><td>0.076</td><td>0.470</td></tr><tr><th>theta[8]</th><td>0.159181</td><td>0.189</td><td>0.000</td><td>0.408</td></tr><tr><th>theta[9]</th><td>0.126710</td><td>0.314</td><td>0.153</td><td>0.476</td></tr><tr><th>theta[10]</th><td>0.133879</td><td>0.322</td><td>0.154</td><td>0.495</td></tr><tr><th>theta[11]</th><td>0.129020</td><td>0.282</td><td>0.131</td><td>0.437</td></tr><tr><th>theta[12]</th><td>0.144806</td><td>0.304</td><td>0.150</td><td>0.470</td></tr><tr><th>theta[13]</th><td>0.032578</td><td>0.223</td><td>0.000</td><td>0.476</td></tr><tr><th>theta[14]</th><td>0.117005</td><td>0.210</td><td>0.021</td><td>0.414</td></tr><tr><th>theta[15]</th><td>0.133092</td><td>0.236</td><td>0.028</td><td>0.458</td></tr><tr><th>theta[16]</th><td>0.108155</td><td>0.133</td><td>0.000</td><td>0.318</td></tr><tr><th>theta[17]</th><td>0.065746</td><td>0.207</td><td>0.001</td><td>0.430</td></tr><tr><th>theta[18]</th><td>0.105766</td><td>0.222</td><td>0.043</td><td>0.415</td></tr><tr><th>theta[19]</th><td>0.124622</td><td>0.230</td><td>0.046</td><td>0.428</td></tr><tr><th>theta[20]</th><td>0.121615</td><td>0.189</td><td>0.037</td><td>0.353</td></tr><tr><th>theta[21]</th><td>0.120505</td><td>0.215</td><td>0.045</td><td>0.408</td></tr><tr><th>rho</th><td>0.183874</td><td>0.211</td><td>0.087</td><td>0.332</td></tr><tr><th>mu[0]</th><td>0.119764</td><td>0.230</td><td>0.053</td><td>0.419</td></tr><tr><th>mu[1]</th><td>0.133596</td><td>0.241</td><td>0.080</td><td>0.418</td></tr><tr><th>mu[2]</th><td>0.140694</td><td>0.202</td><td>0.000</td><td>0.447</td></tr><tr><th>mu[3]</th><td>0.136886</td><td>0.307</td><td>0.164</td><td>0.455</td></tr><tr><th>mu[4]</th><td>0.035124</td><td>0.234</td><td>0.000</td><td>0.504</td></tr><tr><th>mu[5]</th><td>0.137612</td><td>0.228</td><td>0.027</td><td>0.444</td></tr><tr><th>mu[6]</th><td>0.101337</td><td>0.145</td><td>0.000</td><td>0.351</td></tr><tr><th>mu[7]</th><td>0.075024</td><td>0.219</td><td>0.000</td><td>0.460</td></tr><tr><th>mu[8]</th><td>0.118877</td><td>0.214</td><td>0.051</td><td>0.391</td></tr><tr><th>sigma2[0]</th><td>0.101624</td><td>0.131</td><td>0.056</td><td>0.220</td></tr><tr><th>sigma2[1]</th><td>0.097299</td><td>0.150</td><td>0.061</td><td>0.260</td></tr><tr><th>sigma2[2]</th><td>0.094004</td><td>0.118</td><td>0.053</td><td>0.193</td></tr><tr><th>sigma2[3]</th><td>0.103104</td><td>0.135</td><td>0.059</td><td>0.226</td></tr><tr><th>sigma2[4]</th><td>0.105677</td><td>0.117</td><td>0.054</td><td>0.196</td></tr><tr><th>sigma2[5]</th><td>0.091571</td><td>0.125</td><td>0.054</td><td>0.211</td></tr><tr><th>sigma2[6]</th><td>0.107485</td><td>0.118</td><td>0.056</td><td>0.200</td></tr><tr><th>sigma2[7]</th><td>0.106212</td><td>0.118</td><td>0.055</td><td>0.198</td></tr><tr><th>sigma2[8]</th><td>0.105388</td><td>0.138</td><td>0.058</td><td>0.232</td></tr><tr><th>iota[0]</th><td>-0.980943</td><td>-0.954</td><td>-2.131</td><td>0.208</td></tr><tr><th>iota[1]</th><td>-1.108789</td><td>-1.256</td><td>-2.343</td><td>-0.197</td></tr><tr><th>iota[2]</th><td>-0.864302</td><td>-1.390</td><td>-2.993</td><td>0.262</td></tr><tr><th>iota[3]</th><td>-1.395580</td><td>-1.571</td><td>-2.392</td><td>-0.812</td></tr><tr><th>iota[4]</th><td>-1.423259</td><td>-1.163</td><td>-2.829</td><td>0.437</td></tr><tr><th>iota[5]</th><td>-0.037854</td><td>-0.620</td><td>-2.014</td><td>0.734</td></tr><tr><th>iota[6]</th><td>-0.919838</td><td>-1.295</td><td>-2.947</td><td>0.376</td></tr><tr><th>iota[7]</th><td>-1.245577</td><td>-1.039</td><td>-2.644</td><td>0.550</td></tr><tr><th>iota[8]</th><td>-0.524771</td><td>-0.505</td><td>-1.628</td><td>0.633</td></tr><tr><th>gamma[0]</th><td>0.563992</td><td>0.461</td><td>0.429</td><td>0.497</td></tr><tr><th>gamma[1]</th><td>0.180336</td><td>0.191</td><td>0.162</td><td>0.219</td></tr><tr><th>lambda[0]</th><td>0.808996</td><td>0.747</td><td>0.712</td><td>0.785</td></tr><tr><th>lambda[1]</th><td>0.979214</td><td>0.997</td><td>0.996</td><td>0.998</td></tr></tbody></table><h3 id="Conclusion-and-future-work">Conclusion and future work</h3><p>This project aimed to understand &amp; model the nature of setting-specific COVID transmission with the purpose of informing and improving related policy interventions. The first-principles model presented in this article allows us to do this in a way that properly captures the data-generating process behind setting-specific transmission, all with considerations of a simple and feasible data collection methodology. Furthermore, the Bayesian nature of our model allows flexibility when incorporating expert knowledge through priors, as exemplified with the calibrated antigen test accuracy parameters, and provides accurate estimates even with few training samples thanks to its generative nature. Finally, from an implementation perspective, our model is built with scalability in mind, as the TensorFlow Probability version makes it feasible for large-scale applications with the aid of distributed computing architecture.</p><p>There is still much left to be done and many possible extensions could be added to make our model more robust and powerful. One possible angle for future work would be extending the model to encapsulate the effect of other policy interventions (such as social distancing regulations, vaccination, etc.) in order to derive insights about the effectiveness of these in different settings. Another possible extension could be to add temporal dynamics into the model by combining with an SIR-type model.</p><p>Overall, we believe this model serves as a great case for statistical modeling of setting-specific epidemic transmission, with great potential for future extensions and applications to similar settings. Additionally, it serves as a great example of the power of Bayesian modelling and the many benefits it can bring in applied settings.</p></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Authors: </span><span class="post-copyright-info"><a class="post-meta__categories" href="https://www.linkedin.com/in/tim-hargreaves/" target="_blank" rel="noopener">Tim Hargreaves</a><span>, </span><a class="post-meta__categories" href="https://www.linkedin.com/in/patriciohdzs/" target="_blank" rel="noopener">Patricio Hernandez</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Permalink: </span><span class="post-copyright-info"><a href="https://research.wdss.io/track-and-trace/">https://research.wdss.io/track-and-trace/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> unless otherwise specified.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/covid19/">covid19</a><a class="post-meta__tags" href="/tags/bayesian-modelling/">bayesian-modelling</a><a class="post-meta__tags" href="/tags/track-and-trace/">track-and-trace</a></div><div class="post_share"><div class="social-share" data-image="/banners/voting.png" data-sites="facebook,twitter,linkedin"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/oh-hell/"><img class="prev_cover lazyload" data-src="/banners/cards.jpg" onerror='onerror=null,src="/img/404.jpg"'><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">Oh Hell! - Reinforcement Learning for solving card games</div></div></a></div><div class="next-post pull_right"><a href="/chemical-properties/"><img class="next_cover lazyload" data-src="/banners/chemistry-lab.png" onerror='onerror=null,src="/img/404.jpg"'><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">Predicting aqueous solubility with neural networks</div></div></a></div></nav><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> Comment</span></div><div id="disqus_thread"></div><script>var disqus_config=function(){this.page.url="https://research.wdss.io/track-and-trace/",this.page.identifier="track-and-trace/",this.page.title="Reinventing Test and Trace: A Bayesian Approach For Modelling SARS-CoV-2 Setting-Specific Transmission"};!function(){var e=document,t=e.createElement("script");t.src="https://wdss-research-blog.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)}()</script><script>function getDisqusCount(){var s=document,t=s.createElement("script");t.src="https://wdss-research-blog.disqus.com/count.js",t.id="dsq-count-scr",(s.head||s.body).appendChild(t)}window.addEventListener("load",getDisqusCount,!1)</script></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By Warwick Data Science</div><div class="framework-info"><span>Powered By </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="Read Mode"></i><i class="fa fa-plus" id="font_plus" title="Increase font size"></i><i class="fa fa-minus" id="font_minus" title="Decrease font size"></i><i class="darkmode fa fa-moon-o" id="darkmode" title="Dark Mode"></i></div><div id="rightside-config-show"><div id="rightside_config" title="Setting"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="Comments"><i class="scroll_to_comment fa fa-comments"></i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="Table of Contents" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="Back to top" aria-hidden="true"></i></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">Search</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>Powered by</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49b1f5">hexo-generator-search</a></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css"><script>$(function(){$("span.katex-display").wrap('<div class="katex-wrap"></div>')})</script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async></script><script src="/js/search/local-search.js"></script></body></html>